<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.edge.currency.allTask.dao.AllTaskDao">
	<!-- 定义缓存 一般是一级缓存，如果用同一个sqlsession 那么相同查询直接会从缓存中查找 <cache size="1024" flushInterval="60000" 
		eviction="LRU" readOnly="false"></cache> -->

	<!--加载我的已办办列表  -->
	<select id="allTaskList" parameterType="AllTask_QueryVo" resultType="AllTask">
		select * from (select row_.*, rownum rownum_ from (
					   select h.*, p.business_key_
					   from act_hi_taskinst h
					   left join act_hi_procinst p
					   on h.proc_inst_id_ = p.proc_inst_id_
					   <where>h.assignee_ =#{userId}</where> 
                order by h.start_time_ desc
       ) row_
		<where>
			rownum &lt;= #{rows}
		</where>
		)
		<where>
			rownum_ &gt;= #{page}
		</where>
	</select>
	
	<!--加载我的已办列表数量  -->
	<select id="allTaskCount" parameterType="AllTask_QueryVo" resultType="Integer">
		select count(1) from (select h.*, p.business_key_
						      from act_hi_taskinst h
						      left join act_hi_procinst p
						       on h.proc_inst_id_ = p.proc_inst_id_
						    <where>
						      h.assignee_ =#{userId}
						     </where> )
	</select>
</mapper>